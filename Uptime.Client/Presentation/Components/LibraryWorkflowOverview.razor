<MudText Typo="Typo.h5" Class="my-4">Töövood</MudText>

<MudPaper Elevation="0" Outlined="true" Class="pa-4 my-6">
    <MudText Typo="Typo.subtitle1" Class="mt-4 mb-4">Töötavad töövood</MudText>

    @if (ActiveInstances.Count > 0)
    {
        <MudTable Items="ActiveInstances" Bordered="false" Dense="true" Outlined="true">
            <HeaderContent>
                <MudTh>Nimi</MudTh>
                <MudTh>Käivitatud</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd><MudLink Href="@($"/workflow/{context.Id}")">@context.WorkflowTemplateName</MudLink></MudTd>
                <MudTd>@context.StartDate.ToLocalTime()</MudTd>
            </RowTemplate>
        </MudTable>
    }
    else
    {
        <MudText>No active workflows for this document.</MudText>
    }
</MudPaper>

<MudPaper Elevation="0" Outlined="true" Class="pa-4 my-6">
    <MudText Typo="Typo.subtitle1" Class="mt-4 mb-4">Lõpule viidud töövood</MudText>

    @if (CompletedInstances.Count > 0)
    {
        <MudTable Items="CompletedInstances" Bordered="false" Dense="true" Outlined="true">
            <HeaderContent>
                <MudTh>Nimi</MudTh>
                <MudTh>Käivitatud</MudTh>
                <MudTh>Lõpule viidud</MudTh>
                <MudTh>Olek</MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd><MudLink Href="@($"/workflow/{context.Id}")">@context.WorkflowTemplateName</MudLink></MudTd>
                <MudTd>@context.StartDate.ToLocalTime()</MudTd>
                <MudTd>@context.EndDate?.ToLocalTime()</MudTd>
                <MudTd>@context.Outcome</MudTd>
            </RowTemplate>
        </MudTable>
    }
    else
    {
        <MudText>No completed or canceled workflows for this document.</MudText>
    }
</MudPaper>

@code {
    [Parameter, EditorRequired]
    public List<DocumentWorkflow> Workflows { get; set; } = [];

    private List<DocumentWorkflow> ActiveInstances => Workflows.Where(w => w.IsActive).ToList();
    private List<DocumentWorkflow> CompletedInstances => Workflows.Where(w => !w.IsActive).ToList();
}