@page "/workflow/{workflowId:int}"

@inject IMediator Mediator

<MudContainer>
    <MudPaper Elevation="1" Outlined="true" Class="pa-4 mb-6">
        <WorkflowPageDetails ViewModel="_detailsViewModel" />
    </MudPaper>
    <MudPaper Elevation="2" Outlined="true" Class="pa-4 my-6">
        <WorkflowPageActions />
    </MudPaper>
    <MudPaper Elevation="1" Outlined="true" Class="pa-4 my-6">
        <WorkflowPageTasks WorkflowId="WorkflowId" />
    </MudPaper>
    <MudPaper Elevation="1" Outlined="true" Class="pa-4 my-6">
        <WorkflowPageHistory WorkflowId="WorkflowId" />
    </MudPaper>
</MudContainer>

@code {
    private WorkflowDetails? _detailsViewModel;

    [Parameter] public int WorkflowId { get; set; }

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        Result<WorkflowDetails> detailsResult = await Mediator.Send(new GetWorkflowDetailsQuery(WorkflowId));
        if (detailsResult.Succeeded)
        {
            _detailsViewModel = detailsResult.Value;
        }
    }
}