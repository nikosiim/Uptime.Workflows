@inject WorkflowRegistry WorkflowRegistry

<MudPaper Elevation="0" MinHeight="250px">
    <MudText Typo="Typo.h5" Class="my-6">Töövoo mallid</MudText>

    @if (ViewModel != null)
    {
        <MudGrid>
            @foreach (WorkflowTemplateDto template in ViewModel.Templates)
            {
                <MudItem xs="12" sm="6" md="3">
                    <MudPaper Class="pa-3" Elevation="1" Style="min-width: fit-content;">
                        <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="2">
                            <MudAvatar Size="Size.Medium" Color="Color.Primary">
                                <MudIcon Icon="@Icons.Material.Filled.Work" Size="Size.Medium" />
                            </MudAvatar>
                            <MudLink Href="@(GetInitiationFormUrl(template, ViewModel.DocumentId))" Style=" white-space: nowrap;">
                                @template.Name
                            </MudLink>
                        </MudStack>
                    </MudPaper>
                </MudItem>
            }
        </MudGrid>

    }
    else
    {
        <MudText>No workflows available for this list.</MudText>
    }
</MudPaper>

@code {
    [Parameter, EditorRequired] 
    public TemplatesViewModel? ViewModel { get; set; }

    private string GetInitiationFormUrl(WorkflowTemplateDto template, int documentId)
    {
        IWorkflowDefinition definition = WorkflowRegistry.GetWorkflowById(template.WorkflowBaseId);
        return $"/{definition.InitiationPage}/{template.Id}/{documentId}";
    }
}